# Libarary-System 接口文档

- 遵循`RESTFUL`风格 v1.0

- 基础域名：http://localhost:8080/api

- 通用返回格式：

  ```json
  {
      "code": "0",
      "message": null,
      "data": {...},
      "success": true
  }
  ```

> updated at 2025-12-6

## 用户模块

### 用户注册

- 接口路径：`/auth/register`
- 请求方法：`POST`
- 接口描述：发送 用户名、密码、姓名、手机号、角色(可选，不选默认`student`) 完成注册，返回 `Void`

#### 请求参数

| 字段名   | 类型   | 必传 | 默认值 | 描述               | 其他 |
| -------- | ------ | ---- | ------ | ------------------ | ---- |
| username | string | 是   | -      | 长度在4-50字符之间 |      |
| password | string | 是   | -      | 长度在6-20字符之间 |      |
| name     | string | 是   | -      |                    |      |
| phone    | string | 是   | -      |                    |      |
| role     | string | 否   |        |                    |      |

##### 请求示例

```json
{
    "username": "alex",
    "password": "123456",
    "name": "艾利克斯",
    "phone": "12345678910",
    "role": "student"
}
```

#### 返回参数

##### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": null,
    "success": true
}
```

```json
{
    "code": "A000103",
    "message": "用户名已存在",
    "data": null,
    "success": false
}
```

### 用户登录

- 接口路径：`/auth/login`
- 请求方法：`POST`
- 接口描述：通过 用户名、密码 进行登录，返回

#### 请求参数

| 字段名   | 类型   | 必传 | 默认值 | 描述   | 其他 |
| -------- | ------ | ---- | ------ | ------ | ---- |
| username | string | 是   | -      | 不为空 |      |
| password | string | 是   | -      | 不为空 |      |

##### 请求示例

```json
{
    "username": "chaos",
    "password": "Lv050611_"
}
```

#### 返回参数

| 字段名   | 类型   | 描述 | 其他 |
| -------- | ------ | ---- | ---- |
| token    | string |      |      |
| id       | long   |      |      |
| username | string |      |      |
| phone    | string |      |      |
| role     | string |      |      |

##### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": {
        "token": "eyJhbGciOiJIUzM4NCJ9.eyJyb2xlIjoiYWRtaW4iLCJ1c2VySWQiOjEsInN1YiI6ImNoYW9zIiwiaWF0IjoxNzY1MDA3ODE2LCJleHAiOjE3NjUwOTQyMTZ9.nATxaMf68vVh7o0xfUy6tl3RpMbJxcadbohT8SVhHRA9nc_F6QnNPCqdFwvsBT9E",
        "id": 1,
        "username": "chaos",
        "name": "吕建超",
        "role": "admin"
    },
    "success": true
}
```

### 获取当前用户信息

- 接口路径：`/auth/me` 
- 请求方法：`GET` 
- 接口描述：

#### 返回参数

| 字段名    | 类型   | 描述 | 其他 |
| --------- | ------ | ---- | ---- |
| id        | long   |      |      |
| username  | string |      |      |
| role      | string |      |      |
| name      | string |      |      |
| phone     | string |      |      |
| createdAt | Date   |      |      |

##### 返回示例

```json
 {
    "code": "0",
    "message": null,
    "data": {
        "id": 1,
        "username": "chaos",
        "role": "admin",
        "name": "吕建超",
        "phone": "15827110898",
        "createAt": "2025-12-04 15:33:12"
    },
    "success": true
}
```

### 修改用户基础信息

- 接口路径：`/auth/me` 
- 请求方法：`PUT` 
- 接口描述：

#### 请求参数

| 字段名 | 类型   | 必传 | 默认值 | 描述       | 其他 |
| ------ | ------ | ---- | ------ | ---------- | ---- |
| name   | string | 是   | -      | 姓名不为空 |      |
| phone  | string | 是   | -      | 不为空     |      |

##### 请求示例

```json
{
    "name": "吕建超",
    "phone": "123456578910"
}
```

### 修改用户密码

- 接口路径：`/auth/password`
- 请求方法：`PUT`
- 接口描述：通过旧密码验证后修改为新密码，新密码长度需在 6-20 字符之间

#### 请求参数

| 字段名      | 类型   | 必传 | 默认值 | 描述                  | 其他 |
| ----------- | ------ | ---- | ------ | --------------------- | ---- |
| oldPassword | string | 是   | -      | 旧密码，不为空        |      |
| newPassword | string | 是   | -      | 新密码，6-20 字符之间 |      |

##### 请求示例

```json
{
    "oldPassword": "123456",
    "newPassword": "654321"
}
```

#### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": null,
    "success": true
}
```

```json
{
    "code": "A000102",
    "message": "密码错误",
    "data": null,
    "success": false
}
```

## 图书模块

### 获取图书列表

- 接口路径：`/books`
- 请求方法：`GET`
- 接口描述：查询图书列表，支持分页查询（公开接口）

#### 请求参数（Query 参数）

| 字段名   | 类型   | 必传 | 默认值 | 描述             | 其他 |
| -------- | ------ | ---- | ------ | ---------------- | ---- |
| pageNum  | int    | 否   | 1      | 页码             |      |
| pageSize | int    | 否   | 10     | 每页条数         |      |
| title    | string | 否   | -      | 图书标题模糊查询 |      |
| author   | string | 否   | -      | 作者模糊查询     |      |

#### 返回参数

| 字段名   | 类型  | 描述     | 其他 |
| -------- | ----- | -------- | ---- |
| total    | long  | 总条数   |      |
| list     | array | 图书列表 |      |
| pageNum  | int   | 当前页码 |      |
| pageSize | int   | 每页条数 |      |
| pages    | int   | 总页数   |      |

##### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": {
        "total": 100,
        "list": [
            {
                "id": 1,
                "title": "Spring Boot实战",
                "author": "张三",
                "description": "入门教程",
                "isbn": "9787111111111"
            }
        ],
        "pageNum": 1,
        "pageSize": 10,
        "pages": 10
    },
    "success": true
}
```

### 获取图书详情

- 接口路径：`/books/{id}`
- 请求方法：`GET`
- 接口描述：根据图书 ID 获取单本图书详情（公开接口）

#### 请求参数

| 字段名 | 类型 | 必传 | 描述    | 其他     |
| ------ | ---- | ---- | ------- | -------- |
| id     | long | 是   | 图书 ID | 路径参数 |

#### 返回参数

| 字段名      | 类型   | 描述      | 其他 |
| ----------- | ------ | --------- | ---- |
| id          | long   | 图书 ID   |      |
| title       | string | 书名      |      |
| author      | string | 作者      |      |
| description | string | 简介      |      |
| isbn        | string | ISBN 编号 |      |

##### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": {
        "id": 1,
        "title": "Spring Boot实战",
        "author": "张三",
        "description": "入门教程",
        "isbn": "9787111111111"
    },
    "success": true
}
```

### 创建图书

- 接口路径：`/books`
- 请求方法：`POST`
- 接口描述：新增图书（仅管理员可操作）

#### 请求参数

| 字段名      | 类型   | 必传 | 描述      | 其他 |
| ----------- | ------ | ---- | --------- | ---- |
| title       | string | 是   | 书名      |      |
| author      | string | 否   | 作者      |      |
| description | string | 否   | 简介      |      |
| isbn        | string | 否   | ISBN 编号 |      |

##### 请求示例

```json
{
    "title": "Java编程思想",
    "author": "Bruce Eckel",
    "description": "经典Java书籍",
    "isbn": "9787111213826"
}
```

#### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": null,
    "success": true
}
```

```json
{
    "code": "A000105",
    "message": "用户无权限",
    "data": null,
    "success": false
}
```

### 更新图书

- 接口路径：`/books/{id}`
- 请求方法：`PUT`
- 接口描述：根据图书 ID 更新图书信息（仅管理员可操作）

#### 请求参数

| 字段名      | 类型   | 必传 | 描述      | 其他     |
| ----------- | ------ | ---- | --------- | -------- |
| id          | long   | 是   | 图书 ID   | 路径参数 |
| title       | string | 是   | 书名      |          |
| author      | string | 否   | 作者      |          |
| description | string | 否   | 简介      |          |
| isbn        | string | 否   | ISBN 编号 |          |

##### 请求示例

```json
{
    "title": "Java编程思想（第4版）",
    "author": "Bruce Eckel",
    "description": "经典Java书籍，第4版",
    "isbn": "9787111213826"
}
```

#### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": null,
    "success": true
}
```

### 删除图书

- 接口路径：`/books/{id}`
- 请求方法：`DELETE`
- 接口描述：根据图书 ID 删除图书（仅管理员可操作）

#### 请求参数

| 字段名 | 类型 | 必传 | 描述    | 其他     |
| ------ | ---- | ---- | ------- | -------- |
| id     | long | 是   | 图书 ID | 路径参数 |

#### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": null,
    "success": true
}
```

## 借阅模块

### 借书

- 接口路径：`/borrow`
- 请求方法：`POST`
- 接口描述：用户借阅图书（需登录）

#### 请求参数

| 字段名 | 类型 | 必传 | 描述    | 其他       |
| ------ | ---- | ---- | ------- | ---------- |
| bookId | long | 是   | 图书 ID | 请求体参数 |

##### 请求示例

```json
{
    "bookId": 1
}
```

#### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": null,
    "success": true
}
```

### 还书

- 接口路径：`/borrow/return`
- 请求方法：`POST`
- 接口描述：用户归还已借图书（需登录）

#### 请求参数

| 字段名 | 类型 | 必传 | 描述    | 其他       |
| ------ | ---- | ---- | ------- | ---------- |
| bookId | long | 是   | 图书 ID | 请求体参数 |

##### 请求示例

```json
{
    "bookId": 1
}
```

#### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": null,
    "success": true
}
```

### 我的借阅列表

- 接口路径：`/borrow/list`
- 请求方法：`GET`
- 接口描述：查询当前用户的所有借阅记录（需登录）

#### 返回参数

| 字段名     | 类型   | 描述                      | 其他 |
| ---------- | ------ | ------------------------- | ---- |
| id         | long   | 借阅记录 ID               |      |
| bookId     | long   | 图书 ID                   |      |
| bookTitle  | string | 图书标题                  |      |
| borrowTime | Date   | 借阅时间                  |      |
| returnTime | Date   | 归还时间（未归还为 null） |      |

##### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": [
        {
            "id": 1,
            "bookId": 1,
            "bookTitle": "Java编程思想",
            "borrowTime": "2025-12-01 10:00:00",
            "returnTime": null
        }
    ],
    "success": true
}
```

## 预约模块

### 预约图书

- 接口路径：`/reservation`
- 请求方法：`POST`
- 接口描述：用户预约图书（需登录）

#### 请求参数

| 字段名 | 类型 | 必传 | 描述    | 其他       |
| ------ | ---- | ---- | ------- | ---------- |
| bookId | long | 是   | 图书 ID | 请求体参数 |

##### 请求示例

```json
{
    "bookId": 1
}
```

#### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": null,
    "success": true
}
```

### 取消预约

- 接口路径：`/reservation/cancel`
- 请求方法：`POST`
- 接口描述：用户取消图书预约（需登录）

#### 请求参数

| 字段名        | 类型 | 必传 | 描述        | 其他       |
| ------------- | ---- | ---- | ----------- | ---------- |
| reservationId | long | 是   | 预约记录 ID | 请求体参数 |

##### 请求示例

```json
{
    "reservationId": 1
}
```

#### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": null,
    "success": true
}
```

### 我的预约列表

- 接口路径：`/reservation/list`
- 请求方法：`GET`
- 接口描述：查询当前用户的所有预约记录（需登录）

#### 返回参数

| 字段名          | 类型   | 描述        | 其他 |
| --------------- | ------ | ----------- | ---- |
| id              | long   | 预约记录 ID |      |
| bookId          | long   | 图书 ID     |      |
| bookTitle       | string | 图书标题    |      |
| reservationTime | Date   | 预约时间    |      |
| status          | string | 预约状态    |      |

##### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": [
        {
            "id": 1,
            "bookId": 1,
            "bookTitle": "Java编程思想",
            "reservationTime": "2025-12-01 10:00:00",
            "status": "VALID"
        }
    ],
    "success": true
}
```

## 标签模块

### 获取所有标签

- 接口路径：`/tags`
- 请求方法：`GET`
- 接口描述：查询系统中所有图书标签（公开接口）

#### 返回参数

| 字段名 | 类型   | 描述     | 其他 |
| ------ | ------ | -------- | ---- |
| id     | long   | 标签 ID  |      |
| name   | string | 标签名称 |      |

##### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": [
        {
            "id": 1,
            "name": "计算机"
        },
        {
            "id": 2,
            "name": "文学"
        }
    ],
    "success": true
}
```

### 添加标签

- 接口路径：`/tags`
- 请求方法：`POST`
- 接口描述：新增图书标签（仅管理员可操作）

#### 请求参数

| 字段名 | 类型   | 必传 | 描述     | 其他       |
| ------ | ------ | ---- | -------- | ---------- |
| name   | string | 是   | 标签名称 | 请求体参数 |

##### 请求示例

```json
{
    "name": "历史"
}
```

#### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": null,
    "success": true
}
```

### 删除标签

- 接口路径：`/tags/{id}`
- 请求方法：`DELETE`
- 接口描述：根据标签 ID 删除标签（仅管理员可操作）

#### 请求参数

| 字段名 | 类型 | 必传 | 描述    | 其他     |
| ------ | ---- | ---- | ------- | -------- |
| id     | long | 是   | 标签 ID | 路径参数 |

#### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": null,
    "success": true
}
```

## 评论模块

### 发表评论

- 接口路径：`/comments`
- 请求方法：`POST`
- 接口描述：用户对图书发表评论（需登录）

#### 请求参数

| 字段名  | 类型   | 必传 | 描述     | 其他       |
| ------- | ------ | ---- | -------- | ---------- |
| bookId  | long   | 是   | 图书 ID  | 请求体参数 |
| content | string | 是   | 评论内容 | 请求体参数 |

##### 请求示例

```json
{
    "bookId": 1,
    "content": "这本书非常好，推荐阅读！"
}
```

#### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": null,
    "success": true
}
```

### 删除评论

- 接口路径：`/comments/{id}`
- 请求方法：`DELETE`
- 接口描述：用户删除自己发表的评论（需登录）

#### 请求参数

| 字段名 | 类型 | 必传 | 描述    | 其他     |
| ------ | ---- | ---- | ------- | -------- |
| id     | long | 是   | 评论 ID | 路径参数 |

#### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": null,
    "success": true
}
```

### 获取图书评论列表

- 接口路径：`/comments/book/{bookId}`
- 请求方法：`GET`
- 接口描述：查询指定图书的所有评论（公开接口）

#### 请求参数

| 字段名 | 类型 | 必传 | 描述    | 其他     |
| ------ | ---- | ---- | ------- | -------- |
| bookId | long | 是   | 图书 ID | 路径参数 |

#### 返回参数

| 字段名     | 类型   | 描述        | 其他 |
| ---------- | ------ | ----------- | ---- |
| id         | long   | 评论 ID     |      |
| bookId     | long   | 图书 ID     |      |
| userId     | long   | 评论用户 ID |      |
| username   | string | 评论用户名  |      |
| content    | string | 评论内容    |      |
| createTime | Date   | 评论时间    |      |

##### 返回示例

```json
{
    "code": "0",
    "message": null,
    "data": [
        {
            "id": 1,
            "bookId": 1,
            "userId": 1,
            "username": "chaos",
            "content": "这本书非常好，推荐阅读！",
            "createTime": "2025-12-01 15:30:00"
        }
    ],
    "success": true
}
```

## 其他：附加功能

### 获取借阅图书次数最多的前`x`名用户

### 获取被用户借阅次数最多的前`x`本图书

### 获取动态（最新10条的借阅、归还记录）

